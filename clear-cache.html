<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8">
  <title>Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ú©Ø´ - Ø§Ø¨Ø²Ø§Ø±Ø³ØªØ§Ù†</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      background: #0a0a0f;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    .container {
      max-width: 500px;
    }
    h1 { color: #9D0913; margin-bottom: 20px; }
    button {
      background: #9D0913;
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 10px;
      font-size: 16px;
      cursor: pointer;
      margin: 10px;
    }
    button:hover { opacity: 0.9; }
    .status {
      margin-top: 20px;
      padding: 15px;
      border-radius: 10px;
      background: rgba(255,255,255,0.05);
    }
    .success { color: #4ade80; }
    .info { color: #60a5fa; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ§¹ Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ú©Ø´</h1>
    <p>Ø¨Ø±Ø§ÛŒ Ø­Ù„ Ù…Ø´Ú©Ù„Ø§Øª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒØŒ Ú©Ø´ Ù…Ø±ÙˆØ±Ú¯Ø± Ø±Ø§ Ù¾Ø§Ú© Ú©Ù†ÛŒØ¯</p>
    
    <button onclick="clearAllCache()">Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ú©Ø´ Ùˆ Ø±ÙØ±Ø´</button>
    <button onclick="hardReload()">Ø±ÙØ±Ø´ Ø³Ø®Øª (Ctrl+Shift+R)</button>
    <button onclick="goHome()">Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ</button>
    
    <div class="status" id="status"></div>
  </div>

  <script>
    const statusEl = document.getElementById('status');

    async function clearAllCache() {
      statusEl.innerHTML = '<div class="info">Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ú©Ø´...</div>';
      
      try {
        // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Service Worker cache
        if ('serviceWorker' in navigator) {
          const registration = await navigator.serviceWorker.getRegistration();
          if (registration) {
            await registration.unregister();
            statusEl.innerHTML += '<div class="success">âœ… Service Worker Ø­Ø°Ù Ø´Ø¯</div>';
          }
        }

        // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡ Ú©Ø´â€ŒÙ‡Ø§
        if ('caches' in window) {
          const cacheNames = await caches.keys();
          await Promise.all(cacheNames.map(name => caches.delete(name)));
          statusEl.innerHTML += '<div class="success">âœ… Ú©Ø´â€ŒÙ‡Ø§ Ù¾Ø§Ú© Ø´Ø¯Ù†Ø¯</div>';
        }

        // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† localStorage
        localStorage.clear();
        sessionStorage.clear();
        statusEl.innerHTML += '<div class="success">âœ… Storage Ù¾Ø§Ú© Ø´Ø¯</div>';

        statusEl.innerHTML += '<div class="success">âœ… ØªÙ…Ø§Ù…! ØµÙØ­Ù‡ Ø±ÙØ±Ø´ Ù…ÛŒâ€ŒØ´ÙˆØ¯...</div>';
        
        setTimeout(() => {
          window.location.href = '/';
        }, 1500);
      } catch (error) {
        statusEl.innerHTML += '<div style="color: #f87171;">âŒ Ø®Ø·Ø§: ' + error.message + '</div>';
      }
    }

    function hardReload() {
      statusEl.innerHTML = '<div class="info">Ø±ÙØ±Ø´ Ø³Ø®Øª...</div>';
      setTimeout(() => {
        window.location.reload(true);
      }, 500);
    }

    function goHome() {
      window.location.href = '/';
    }

    // Ù†Ù…Ø§ÛŒØ´ ÙˆØ¶Ø¹ÛŒØª ÙØ¹Ù„ÛŒ
    window.addEventListener('load', async () => {
      let info = '<div class="info">ÙˆØ¶Ø¹ÛŒØª ÙØ¹Ù„ÛŒ:</div>';
      
      if ('serviceWorker' in navigator) {
        const registration = await navigator.serviceWorker.getRegistration();
        info += registration ? 
          '<div>ğŸ”µ Service Worker: ÙØ¹Ø§Ù„</div>' : 
          '<div>âšª Service Worker: ØºÛŒØ±ÙØ¹Ø§Ù„</div>';
      }

      if ('caches' in window) {
        const cacheNames = await caches.keys();
        info += `<div>ğŸ“¦ ØªØ¹Ø¯Ø§Ø¯ Ú©Ø´: ${cacheNames.length}</div>`;
      }

      statusEl.innerHTML = info;
    });
  </script>
</body>
</html>
