<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ูพูู ูุฏุฑุช - ุงุจุฒุงุฑุณุชุงู</title>
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="/admin/admin.css" />
</head>
<body>
  <!-- Login Screen -->
  <div id="loginScreen" class="login-container">
    <div class="login-box">
      <div class="login-logo">
        <img src="/assets/logo/logo.svg" alt="ุงุจุฒุงุฑุณุชุงู" width="60" />
      </div>
      <h1>๐ ูุฑูุฏ ุจู ูพูู ูุฏุฑุช</h1>
      <div id="loginAlert"></div>
      <form id="loginForm">
        <div class="form-group">
          <label>ูุงู ฺฉุงุฑุจุฑ</label>
          <input type="text" id="username" required autocomplete="username" />
        </div>
        <div class="form-group">
          <label>ุฑูุฒ ุนุจูุฑ</label>
          <input type="password" id="password" required autocomplete="current-password" />
        </div>
        <button type="submit" class="btn btn-red" style="width: 100%;">ูุฑูุฏ ุจู ูพูู</button>
      </form>
    </div>
  </div>

  <!-- Admin Panel -->
  <div id="adminPanel" style="display: none;">
    <!-- Sidebar -->
    <aside class="admin-sidebar">
      <div class="sidebar-header">
        <img src="/assets/logo/logo.svg" alt="ุงุจุฒุงุฑุณุชุงู" width="40" />
        <h2>ุงุจุฒุงุฑุณุชุงู</h2>
      </div>
      
      <nav class="sidebar-nav">
        <button class="nav-item active" onclick="switchTab('dashboard')">
          <span class="nav-icon">๐</span>
          <span>ุฏุงุดุจูุฑุฏ</span>
        </button>
        <button class="nav-item" onclick="switchTab('articles')">
          <span class="nav-icon">๐</span>
          <span>ููุงูุงุช</span>
        </button>
        <button class="nav-item" onclick="switchTab('tools')">
          <span class="nav-icon">๐ง</span>
          <span>ุงุจุฒุงุฑูุง</span>
        </button>
        <button class="nav-item" onclick="switchTab('files')">
          <span class="nav-icon">๐</span>
          <span>ูุงูโูุง</span>
        </button>
        <button class="nav-item" onclick="switchTab('templates')">
          <span class="nav-icon">๐</span>
          <span>ุชููพูุชโูุง</span>
        </button>
        <button class="nav-item" onclick="switchTab('settings')">
          <span class="nav-icon">โ๏ธ</span>
          <span>ุชูุธูุงุช</span>
        </button>
      </nav>

      <div class="sidebar-footer">
        <button onclick="logout()" class="btn btn-ghost btn-sm">
          <span>๐ช</span>
          ุฎุฑูุฌ
        </button>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="admin-main">
      <!-- Header -->
      <header class="admin-header">
        <div>
          <h1 id="pageTitle">ุฏุงุดุจูุฑุฏ</h1>
          <p id="pageSubtitle">ูุฏุฑุช ูุญุชูุง ู ุณุณุชู</p>
        </div>
        <div class="header-actions">
          <button class="btn btn-ghost btn-sm" onclick="refreshData()">
            <span id="refreshIcon">๐</span>
            ุจุฑูุฒุฑุณุงู
          </button>
        </div>
      </header>

      <!-- Dashboard Panel -->
      <div id="dashboardPanel" class="admin-panel active">
        <!-- Status Cards -->
        <div class="status-grid">
          <div class="status-card">
            <div class="status-icon" style="background: rgba(34, 197, 94, 0.1); color: #22c55e;">โ</div>
            <div class="status-info">
              <h3 id="kvStatus">ุจุฑุฑุณ...</h3>
              <p>ูุถุนุช KV Database</p>
            </div>
          </div>

          <div class="status-card">
            <div class="status-icon" style="background: rgba(59, 130, 246, 0.1); color: #3b82f6;">๐</div>
            <div class="status-info">
              <h3 id="envStatus">ุจุฑุฑุณ...</h3>
              <p>Environment Variables</p>
            </div>
          </div>

          <div class="status-card">
            <div class="status-icon" style="background: rgba(168, 85, 247, 0.1); color: #a855f7;">๐</div>
            <div class="status-info">
              <h3 id="articlesCount">0</h3>
              <p>ุชุนุฏุงุฏ ููุงูุงุช</p>
            </div>
          </div>

          <div class="status-card">
            <div class="status-icon" style="background: rgba(251, 146, 60, 0.1); color: #fb923c;">๐ง</div>
            <div class="status-info">
              <h3 id="toolsCount">0</h3>
              <p>ุชุนุฏุงุฏ ุงุจุฒุงุฑูุง</p>
            </div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="admin-card">
          <h2>ุฏุณุชุฑุณ ุณุฑุน</h2>
          <div class="quick-actions">
            <button class="quick-action" onclick="switchTab('articles')">
              <span class="quick-icon">๐</span>
              <span>ููุงูู ุฌุฏุฏ</span>
            </button>
            <button class="quick-action" onclick="switchTab('tools')">
              <span class="quick-icon">๐ง</span>
              <span>ุงุจุฒุงุฑ ุฌุฏุฏ</span>
            </button>
            <button class="quick-action" onclick="switchTab('files')">
              <span class="quick-icon">๐ค</span>
              <span>ุขูพููุฏ ูุงู</span>
            </button>
            <button class="quick-action" onclick="switchTab('templates')">
              <span class="quick-icon">๐</span>
              <span>ุชููพูุชโูุง</span>
            </button>
          </div>
        </div>

        <!-- Recent Activity -->
        <div class="admin-card">
          <h2>ุขุฎุฑู ูุนุงูุชโูุง</h2>
          <div id="recentActivity" class="activity-list">
            <p style="color: var(--muted); text-align: center;">ุฏุฑ ุญุงู ุจุงุฑฺฏุฐุงุฑ...</p>
          </div>
        </div>
      </div>

      <!-- Articles Panel -->
      <div id="articlesPanel" class="admin-panel">
        <div class="panel-grid">
          <div class="admin-card">
            <h2>ุงูุฒูุฏู ููุงูู ุฌุฏุฏ</h2>
            <form id="articleForm">
              <div class="form-group">
                <label>ุนููุงู ููุงูู *</label>
                <input type="text" id="articleTitle" required placeholder="ุนููุงู ุฌุฐุงุจ ู ุฎูุงูุฏู" />
              </div>
              
              <div class="form-group">
                <label>ุฎูุงุตู ููุงูู</label>
              </div>
              
              <div class="form-group">
                <label>ุฎูุงุตู ููุงูู (Excerpt)</label>
                <textarea id="articleExcerpt" rows="3" required placeholder="ุฎูุงุตูโุง ฺฉูุชุงู ู ุฌุฐุงุจ ุงุฒ ูุญุชูุง ููุงูู..."></textarea>
              </div>
              
              <div class="form-group">
                <label>ูุญุชูุง ููุงูู (Markdown)</label>
                <div class="editor-toolbar">
                  <button type="button" class="editor-btn" onclick="insertMarkdown('h2')" title="ุนููุงู">
                    <strong>H2</strong>
                  </button>
                  <button type="button" class="editor-btn" onclick="insertMarkdown('h3')" title="ุฒุฑุนููุงู">
                    <strong>H3</strong>
                  </button>
                  <button type="button" class="editor-btn" onclick="insertMarkdown('bold')" title="ุถุฎู">
                    <strong>B</strong>
                  </button>
                  <button type="button" class="editor-btn" onclick="insertMarkdown('italic')" title="ฺฉุฌ">
                    <em>I</em>
                  </button>
                  <button type="button" class="editor-btn" onclick="insertMarkdown('list')" title="ูุณุช">
                    โฐ
                  </button>
                  <button type="button" class="editor-btn" onclick="insertMarkdown('link')" title="ููฺฉ">
                    ๐
                  </button>
                  <button type="button" class="editor-btn" onclick="insertMarkdown('image')" title="ุชุตูุฑ">
                    ๐ผ๏ธ
                  </button>
                  <button type="button" class="editor-btn" onclick="insertMarkdown('quote')" title="ููู ููู">
                    "
                  </button>
                  <button type="button" class="editor-btn" onclick="insertMarkdown('code')" title="ฺฉุฏ">
                    &lt;/&gt;
                  </button>
                </div>
                <textarea id="articleContent" rows="15" required placeholder="# ุนููุงู ุงุตู&#10;&#10;## ุจุฎุด ุงูู&#10;&#10;ูุชู ุดูุง...&#10;&#10;![ุชูุถุญ ุชุตูุฑ](/assets/images/photo.png)&#10;*ุชูุถุญ ุฒุฑ ุชุตูุฑ*"></textarea>
                <div class="editor-help">
                  <details>
                    <summary>ุฑุงูููุง ููุดุชู (Markdown)</summary>
                    <div class="help-content">
                      <p><code># ุนููุงู</code> โ ุนููุงู ุงุตู</p>
                      <p><code>## ุนููุงู</code> โ ุนููุงู ุจุฎุด</p>
                      <p><code>### ุฒุฑุนููุงู</code> โ ุฒุฑุนููุงู</p>
                      <p><code>**ูุชู ุถุฎู**</code> โ <strong>ูุชู ุถุฎู</strong></p>
                      <p><code>*ูุชู ฺฉุฌ*</code> โ <em>ูุชู ฺฉุฌ</em></p>
                      <p><code>- ุขุชู ูุณุช</code> โ ูุณุช</p>
                      <p><code>[ูุชู ููฺฉ](url)</code> โ ููฺฉ</p>
                      <p><code>![ุชูุถุญ](url)</code> โ ุชุตูุฑ</p>
                      <p><code>*ุชูุถุญ ุฒุฑ ุชุตูุฑ*</code> โ ฺฉูพุดู</p>
                    </div>
                  </details>
                </div>
              </div>
              
              <div class="form-row">
                <div class="form-group">
                  <label>ุฏุณุชูโุจูุฏ</label>
                  <select id="articleCategory" required>
                    <option value="">ุงูุชุฎุงุจ ฺฉูุฏ</option>
                    <option value="ุชุญูู">ุชุญูู</option>
                    <option value="ุขููุฒุด">ุขููุฒุด</option>
                    <option value="ุงุฎุจุงุฑ">ุงุฎุจุงุฑ</option>
                    <option value="ุงููุช">ุงููุช</option>
                    <option value="ููุงูุฑ">ููุงูุฑ</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>ููุณูุฏู</label>
                  <input type="text" id="articleAuthor" value="ุงุจุฒุงุฑุณุชุงู" required />
                </div>
              </div>
              
              <div class="form-group">
                <label>ุจุฑฺุณุจโูุง (ุจุง ฺฉุงูุง ุฌุฏุง ฺฉูุฏ)</label>
                <input type="text" id="articleTags" placeholder="ูุซุงู: ุงูุชุฑูุช, ุงููุช, ููุชุฑูฺฏ" />
              </div>
              
              <div class="form-group">
                <label>ุชุตูุฑ ุดุงุฎุต</label>
                <div class="image-input-group">
                  <input type="text" id="articleImage" placeholder="/assets/images/cover.png" />
                  <button type="button" class="btn btn-ghost btn-sm" onclick="selectImageFromFiles()">ุงูุชุฎุงุจ ุงุฒ ูุงูโูุง</button>
                </div>
                <small style="color: var(--muted); display: block; margin-top: 4px;">
                  ุชุตุงูุฑ ููุฌูุฏ: war.png, sms.png, ai.png, audio.png, head-banner.png
                </small>
              </div>
              
              <div class="form-group">
                <label style="display: flex; align-items: center; gap: 8px;">
                  <input type="checkbox" id="articlePublished" checked />
                  ุงูุชุดุงุฑ ููุฑ
                </label>
              </div>
              
              <div style="display: flex; gap: var(--space-sm);">
                <button type="submit" class="btn btn-red">
                  <span id="articleSubmitText">ุงูุชุดุงุฑ ููุงูู</span>
                </button>
                <button type="button" class="btn btn-ghost" onclick="previewArticle()">ูพุดโููุงุด</button>
                <button type="button" class="btn btn-ghost" onclick="resetArticleForm()" id="cancelEditBtn" style="display: none;">ุงูุตุฑุงู</button>
              </div>
            </form>
          </div>

          <div class="admin-card">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-lg);">
              <h2 style="margin: 0;">ููุงูุงุช ููุชุดุฑ ุดุฏู</h2>
              <span id="articlesTotal" class="badge">0</span>
            </div>
            <div id="articlesList" class="items-list"></div>
          </div>
        </div>
      </div>

      <!-- Tools Panel -->
      <div id="toolsPanel" class="admin-panel">
        <div class="panel-grid">
          <div class="admin-card">
            <h2>ุงูุฒูุฏู ุงุจุฒุงุฑ ุฌุฏุฏ</h2>
            <form id="toolForm">
              <div class="form-group">
                <label>ูุงู ุงุจุฒุงุฑ *</label>
                <input type="text" id="toolName" required placeholder="ูุงู ุงุจุฒุงุฑ" />
              </div>
              
              <div class="form-group">
                <label>ุชูุถุญุงุช</label>
                <textarea id="toolDescription" rows="3" placeholder="ุชูุถุญุงุช ฺฉูุชุงู ุฏุฑุจุงุฑู ุงุจุฒุงุฑ"></textarea>
              </div>
              
              <div class="form-row">
                <div class="form-group">
                  <label>ุฏุณุชูโุจูุฏ</label>
                  <select id="toolCategory">
                    <option value="vpn">VPN</option>
                    <option value="security">ุงููุช</option>
                    <option value="proxy">ูพุฑูฺฉุณ</option>
                    <option value="browser">ูุฑูุฑฺฏุฑ</option>
                    <option value="dns">DNS</option>
                    <option value="messaging">ูพุงูโุฑุณุงู</option>
                    <option value="other">ุณุงุฑ</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>ุขฺฉู (ุงููุฌ)</label>
                  <input type="text" id="toolIcon" placeholder="๐" maxlength="2" />
                </div>
              </div>
              
              <div class="form-group">
                <label>ููฺฉ ุฏุงูููุฏ</label>
                <input type="url" id="toolLink" placeholder="https://..." />
              </div>
              
              <div id="toolAlert"></div>
              <button type="submit" class="btn btn-red">ุงูุฒูุฏู ุงุจุฒุงุฑ</button>
              <button type="button" class="btn btn-ghost" onclick="useTemplate('tool')">ุงุณุชูุงุฏู ุงุฒ ุชููพูุช</button>
            </form>
          </div>

          <div class="admin-card">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-lg);">
              <h2 style="margin: 0;">ุงุจุฒุงุฑูุง ููุฌูุฏ</h2>
              <span id="toolsTotal" class="badge">0</span>
            </div>
            <div id="toolsList" class="items-list"></div>
          </div>
        </div>
      </div>

      <!-- Files Panel -->
      <div id="filesPanel" class="admin-panel">
        <div class="admin-card">
          <h2>ูุฏุฑุช ูุงูโูุง</h2>
          <div class="upload-area" id="uploadArea">
            <input type="file" id="fileInput" style="display: none;" multiple />
            <div class="upload-icon">๐ค</div>
            <h3>ูุงู ุฑุง ุงูุฌุง ุจฺฉุดุฏ ุง ฺฉูฺฉ ฺฉูุฏ</h3>
            <p>ุญุฏุงฺฉุซุฑ ุญุฌู: 25MB โข ูุฑูุชโูุง ูุฌุงุฒ: ููู</p>
          </div>
          <div id="uploadAlert"></div>
          <div id="uploadProgress" class="upload-progress" style="display: none;">
            <div class="progress-bar">
              <div class="progress-fill" id="progressFill"></div>
            </div>
            <p id="progressText">ุฏุฑ ุญุงู ุขูพููุฏ...</p>
          </div>
          <div id="filesList" class="files-grid"></div>
        </div>
      </div>

      <!-- Templates Panel -->
      <div id="templatesPanel" class="admin-panel">
        <div class="admin-card">
          <h2>ุชููพูุชโูุง ุขูุงุฏู</h2>
          <p style="color: var(--muted); margin-bottom: var(--space-xl);">ุจุง ุงุณุชูุงุฏู ุงุฒ ุชููพูุชโูุง ุขูุงุฏูุ ุณุฑุนโุชุฑ ูุญุชูุง ุงุฌุงุฏ ฺฉูุฏ</p>
          
          <div class="templates-grid" id="templatesGrid"></div>
        </div>
      </div>

      <!-- Settings Panel -->
      <div id="settingsPanel" class="admin-panel">
        <div class="admin-card">
          <h2>ุชูุธูุงุช ุณุณุชู</h2>
          
          <div class="settings-section">
            <h3>ุงุทูุงุนุงุช ูุญุท (Environment)</h3>
            <div class="env-info">
              <div class="env-item">
                <span class="env-label">ADMIN_USERNAME:</span>
                <span class="env-value" id="envUsername">***</span>
              </div>
              <div class="env-item">
                <span class="env-label">ADMIN_PASSWORD:</span>
                <span class="env-value">โขโขโขโขโขโขโขโข</span>
              </div>
              <div class="env-item">
                <span class="env-label">KV Namespace ID:</span>
                <span class="env-value" id="kvNamespace">ุจุฑุฑุณ...</span>
              </div>
            </div>
          </div>

          <div class="settings-section">
            <h3>ุนููุงุช ุฎุทุฑูุงฺฉ</h3>
            <button class="btn btn-ghost" onclick="clearCache()">ูพุงฺฉ ฺฉุฑุฏู ฺฉุด</button>
            <button class="btn btn-ghost" onclick="exportData()">ุฏุงูููุฏ ุจฺฉุงูพ</button>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script type="module" src="/admin/admin.js"></script>
  <script src="/admin/article-manager.js"></script>
</body>
</html>
